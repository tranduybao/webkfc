!function(o){"use strict";const n=addonifyQuickViewPublicScriptObject.animateModelOnClose,e=addonifyQuickViewPublicScriptObject.closeModalOnEscClicked,i=addonifyQuickViewPublicScriptObject.closeModelOnOutsideClicked,t=addonifyQuickViewPublicScriptObject.enableWcGalleryLightBox;let a=jQuery("#addonify-quick-view-modal #adfy-quick-view-modal-content");const c={loadOnReady:function(){this.handleQuickViewButtonEvents(),this.handleCloseButtonEvents(),this.initPerfectScrollbar(),this.calculateModalHeight(),this.handleQVModalEvents()},loadOnScroll:function(){},loadOnResize:function(){this.calculateModalHeight()},handleQVModalEvents:function(){o(document).on("addonifyQuickViewModalContentLoading",function(e){o("body").addClass("addonify-qvm-is-active"),c.setSpinner("show"),a.html(" ")}),o(document).on("addonifyQuickViewModalContentLoaded",function(e,n){void 0!==n&&n.hasOwnProperty("content")&&(c.hydrateModalContent(n.content),c.scrollIntoView(),c.setSpinner("hide"),d.open())}),o(document).on("addonifyQuickViewModalOpened",function(e){c.initPerfectScrollbar(),c.initiateVariationForm(),c.initiateWCGallery(),t&&c.renderWooCommerceGalleryTriggerIcon(),addonifyQuickViewPublicScriptObject.hasOwnProperty("wcsattEnabled")&&"1"===addonifyQuickViewPublicScriptObject.wcsattEnabled&&o(document.body).trigger("wcsatt-initialize")})},handleQuickViewButtonEvents:function(){o("body").on("click",".addonify-qvm-button",function(e){e.preventDefault(),addonifyQuickViewPublicScriptObject.hasOwnProperty("quickViewAction")&&c.getModalContent(parseInt(o(this).data("product_id")))})},handleCloseButtonEvents:function(){o("body").on("click","#addonify-quick-view-modal-close",function(e){e.preventDefault(),n?d.animate():d.close()}),e&&o(document).keyup(function(e){27===e.keyCode&&(n?d.animate():d.close())}),i&&(o("#addonify-quick-view-modal-wrapper").css("cursor","pointer"),o("body").on("click","#addonify-quick-view-modal-wrapper",function(e){"addonify-quick-view-modal-wrapper"===e.target.id&&(n?d.animate():d.close())}))},setSpinner:function(e){var n=o("#adfy-qvm-spinner");"show"===e?n.removeClass("hide"):n.addClass("hide")},getModalContent:function(e){if(!e)throw new Error("Addonify Quick View: Product id is not supplied!");d.modalContentLoading(),o.ajax({type:"GET",url:addonifyQuickViewPublicScriptObject.ajaxURL,contentType:"application/json; charset=utf-8",data:{action:addonifyQuickViewPublicScriptObject.quickViewAction,product_id:e,nonce:addonifyQuickViewPublicScriptObject.nonce},success:function(e){e.success?e.success&&d.modalContentLoaded(e.data):console.warn(e.message)},error:function(e,n){console.log(n)}})},hydrateModalContent:function(e){a.html(e);e=a.find("form.cart");0<e.length&&e.removeAttr("action")},initiateVariationForm:function(){var e=a.find(".variations_form");0<e.length&&(e.each(function(){o(this).wc_variation_form()}),e.trigger("check_variations"),e.trigger("reset_image"))},initiateWCGallery:function(){var e=o("#addonify-quick-view-modal .woocommerce-product-gallery");0<e.length&&e.each(function(){o(this).wc_product_gallery()})},initPerfectScrollbar:function(){var e;"function"==typeof PerfectScrollbar?(e=document.getElementById("adfy-quick-view-model-inner"))&&new PerfectScrollbar(e,{wheelSpeed:1,wheelPropagation:!0,minScrollbarLength:20}):console.warn("Addonify Quick View: PerfectScrollbar is not defined. Perfect scroll bar won't be initialized.")},renderWooCommerceGalleryTriggerIcon:function(){var e=o("#addonify-quick-view-modal .woocommerce-product-gallery__trigger");0<e.length&&(e.html(" "),e.html('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M24,8V2a2,2,0,0,0-2-2H16V2h4.586L12,10.586,3.414,2H8V0H2A2,2,0,0,0,0,2V8H2V3.414L10.586,12,2,20.586V16H0v6a2,2,0,0,0,2,2H8V22H3.414L12,13.414,20.586,22H16v2h6a2,2,0,0,0,2-2V16H22v4.586L13.414,12,22,3.414V8Z"/></svg>'))},calculateModalHeight:function(){var e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=document.getElementById("addonify-quick-view-modal");n&&(n.style.maxHeight=e-40+"px")},scrollIntoView:function(){var e=o("#adfy-quick-view-model-inner");0<e.length&&e.animate({scrollTop:0},"slow")}},d={open:function(){o("body").addClass("addonify-qvm-is-active"),o(document).trigger("addonifyQuickViewModalOpened"),document.dispatchEvent(new CustomEvent("addonifyQuickViewModalOpened"))},close:function(){o("body").removeClass("addonify-qvm-is-active"),o(document).trigger("addonifyQuickViewModalClosed"),document.dispatchEvent(new CustomEvent("addonifyQuickViewModalClosed"))},animate:function(){let e=null,n=null,i=o("#addonify-quick-view-modal-wrapper");i.removeClass("play-opening-animation"),i.addClass("play-closing-animation"),clearTimeout(n),n=setTimeout(()=>{this.close(),i.removeClass("play-closing-animation"),clearTimeout(n)},800),clearTimeout(e),e=setTimeout(()=>{i.addClass("play-opening-animation"),clearTimeout(e)},1200)},modalContentLoading:function(){jQuery(document).trigger("addonifyQuickViewModalContentLoading"),document.dispatchEvent(new CustomEvent("addonifyQuickViewModalContentLoading"))},modalContentLoaded:function(e){e={content:e};o(document).trigger("addonifyQuickViewModalContentLoaded",[e]),document.dispatchEvent(new CustomEvent("addonifyQuickViewModalContentLoaded",{detail:e}))}};o(document).ready(function(){c.loadOnReady()}),o(window).on("scroll",function(){c.loadOnScroll()}),o(window).on("resize",function(){c.loadOnResize()})}(jQuery);